# Data

## Relational Databases

* Concepts: Pre-Read

[RDBMS Concepts](https://beginnersbook.com/2015/04/rdbms-concepts/)

* Tables
* Record/Tuple
* Field/Column
* Domain (permitted values)
* Instance
* Keys

### Key Concepts

* Relational DB's are used for data storage, with a specific set of goals: Efficiency, Ease of Access, Organiation, Handle Relations.
* ACID - atomicity, consistency, isolation, durability.
* Atomicity - ensures that partially failed transactions can be rolled back.
* Consistency - ensures that the balance between transactions does not even occur.
* Isolation guaragtees that multiple sub-operations which make up a transaction do not overwrite each other.
* Durability ensures that changes are applied correctly during recovery.

CRUD Operations

* CRUD - create, read, update, delete.
#### Classifying Operation by Type:

Management Operations

* DDL - definition
* DML - manipulation
* DCL - control
* TCL - transactions

* insert - transaction; inserting a value is a transaction
* create - definition; creating a table is to define something, no values inserted
* drop - definition; dropping or deleting tables
* delete - manipulation; deleting values is equivalent to changing, manipulating
* update - manipulation; updating a value
* commit - transaction; creating an entry
* rollback - manipulation; similar to updating
* truncate - manipulation; similar to deleting
* alter - manipulation; similar to deleting
* grant - control; granting actual outside access
* revoke - control; granting or revoking access

#### Other Definitions

* Constraints - rules for data that can be stored. Queries fail if defines rules are violated.
* Indexes - using a B+ structure, speeding up the fetching of rows and queries.
* Joins - allows you to fetch related data from multiple tables
* Access control - privledged accounts for admin tasks and regular accounts for clients

#### Popular Databases

* Commercial, closed source - Oracle, Microsoft SQL Server, IBM DB2
* Open source with optional paid support - MySQL, MariaDB, PostgreSQL

### MySQL

* Read through this...similar to Postgres

* Has an application layer which covers connection handling, authentication, security.
* Has a server layer which covers backup and restore, SQL interface, parser and optimization.
* Storage engine - InnoDB, which is the most widely used, transaction support, ACID compliant, crash recovery, etc.
* Possible to migrate from one storage engine to another, but this migration locks tables for all operations.

### InnoDB

* Memory - buffer pool, LRU cache of frequently used data. Has a change buffer, adaptive hash index, log buffer, which holds log data before flush to disk.
* Disk - stores data in rows and columns.
* Indexes - helps find rows with specific column values quickly.
* Redo logs - all transactions are written to them.

### Backup and Recovery

* Physical Backup - data directory as it is on the disk
* Logical Backup - table structure and records in it.

#### Mysqldump

This utility is available with MySQL installation, helps with the logical backup of the database, outputs a set of SQL statements to reconstruct the data, it is not recommended to use for large tables as it may take a lot of time and the file size will be huge.

```
mysqldump [options] > dump_output.sql
```

To dump all databases...

```
mysqldump -u<user> -p<pwd> --all-databases > dbs.sql
```
To dump a single database, a specific one:

```
mysqldump -u<user> -p<pwd> --databases db1 db2 > dbs.sql
```
Specific tables:

```
mysqldump -u<user> -p<pwd> db1 table1 table2 > db1_tables.sql
```
##### Restoring

From shell

```
mysql -u<user> -p<pwd> < all_dbs.sql
```

from shell if database already created:

```
mysql -u<user> -p<pwd> db1 < db1.sql
```

or from within MySQL Shell:

```
mysql> source all_dbs.sql
```

##### Percona Xtrabackkup

Utility which provides backups.

* Full, partial or cumulative.

* There are other SQL backup tools. - point-in-time recoveries, mysqlpump, mysqldumper, etc.

### MySQL Replication

Replication enables data from on MySQL host (primary) to be copied to another host, (replica). MySQL replication is asynchronous by nature by default, but it can be changed to semi-synchronous.

#### Applications 

* Read-scaling: set up as many replicas as we need and scale reads through them, which improves write performance, as the primary source is only dedicated to writes and not reads.
* Backups using replicas.
* Disaster recovery.

#### Asynchronizations

* Asynchronous is the default method. One host serves as the primary and one or more as the replicas.
* Semi-synchronous means that a commit is performed on the primary host is blocked until at least one of the replicas acknowledge it. This ensures strong consistency.
* Delayed - we can deliberaly delay, so that the replicas get updated and show the source of truth later. This safeguards against human errors, e.g. if a drop database is executed by mistake on the primary, the replica may still have the original copy, for a while at least.

### Pre-Requisites



### Operational Concepts

### Lab

### Conclusion

## NoSQL



## Big Data